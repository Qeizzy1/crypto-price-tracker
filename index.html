<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>moonLive - Crypto Insights</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');

    body {
      margin: 0;
      background-color: #fff;
      color: #b91c1c; /* Red text */
      font-family: 'Roboto', sans-serif;
      padding: 20px;
      user-select: none;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 900;
      font-size: 2.8rem;
      color: #b91c1c;
      letter-spacing: 2px;
    }

    .container {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 2px 8px rgba(185, 28, 28, 0.15);
      border-radius: 8px;
      overflow: hidden;
    }

    thead {
      background-color: #b91c1c;
      color: white;
      user-select: none;
    }

    thead th {
      padding: 12px 10px;
      font-weight: 700;
      text-align: left;
      font-size: 1rem;
    }

    tbody tr:nth-child(even) {
      background-color: #fee2e2; /* light red/pink */
    }

    tbody tr:hover {
      background-color: #fca5a5; /* brighter red */
      cursor: default;
    }

    tbody td {
      padding: 10px;
      font-size: 0.9rem;
    }

    .coin-name {
      font-weight: 600;
    }

    .price-change {
      font-weight: 700;
      text-align: right;
      color: #b91c1c;
    }

    .price-change.up {
      color: #047857; /* green for positive */
    }

    @media (max-width: 900px) {
      .container {
        flex-direction: column;
      }
      table {
        margin-bottom: 30px;
      }
    }
  </style>
</head>
<body>
  <h1>moonLive Crypto Insights</h1>
  <div class="container">
    <!-- Newly Created -->
    <table aria-label="Newly Created Coins">
      <thead>
        <tr><th colspan="2">Newly Created Coins</th></tr>
        <tr><th>Name</th><th>Created Date</th></tr>
      </thead>
      <tbody id="newlyCreatedBody">
        <tr><td colspan="2" style="text-align:center;">Loading...</td></tr>
      </tbody>
    </table>

    <!-- About to Pump -->
    <table aria-label="Coins About to Pump">
      <thead>
        <tr><th colspan="2">Coins About to Pump</th></tr>
        <tr><th>Name</th><th>24h Change (%)</th></tr>
      </thead>
      <tbody id="pumpBody">
        <tr><td colspan="2" style="text-align:center;">Loading...</td></tr>
      </tbody>
    </table>

    <!-- Market Cap > 50k -->
    <table aria-label="Coins with Market Cap over 50k">
      <thead>
        <tr><th colspan="2">Coins with Market Cap &gt; 50k</th></tr>
        <tr><th>Name</th><th>Market Cap (USD)</th></tr>
      </thead>
      <tbody id="marketCapBody">
        <tr><td colspan="2" style="text-align:center;">Loading...</td></tr>
      </tbody>
    </table>
  </div>

<script>
  async function fetchCoins() {
    try {
      const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=1&price_change_percentage=24h`;
      const res = await fetch(url);
      const data = await res.json();
      return data;
    } catch (e) {
      console.error('Failed to fetch data:', e);
      return null;
    }
  }

  function formatDate(isoDateStr) {
    if (!isoDateStr) return '-';
    const d = new Date(isoDateStr);
    return d.toLocaleDateString();
  }

  function formatNumber(num) {
    if (!num) return '-';
    return num.toLocaleString(undefined, {maximumFractionDigits: 0});
  }

  async function populateTables() {
    const data = await fetchCoins();
    if (!data) {
      document.getElementById('newlyCreatedBody').innerHTML = `<tr><td colspan="2" style="color:#b91c1c; text-align:center;">Failed to load</td></tr>`;
      document.getElementById('pumpBody').innerHTML = `<tr><td colspan="2" style="color:#b91c1c; text-align:center;">Failed to load</td></tr>`;
      document.getElementById('marketCapBody').innerHTML = `<tr><td colspan="2" style="color:#b91c1c; text-align:center;">Failed to load</td></tr>`;
      return;
    }

    // Newly Created - use 'genesis_date' from coin details - but markets API doesn't include that
    // So we need to fetch coin details per coin (costly, so we'll just simulate by filtering coins with low market cap and recent addition)
    // Instead, we'll use coins with low market cap and sort by market cap ascending, and treat them as "newly created" for demo.
    const newlyCreated = data
      .filter(c => c.market_cap && c.market_cap < 500000) // low market cap as proxy
      .slice(0, 15);

    const pumpCoins = data
      .filter(c => c.price_change_percentage_24h && c.price_change_percentage_24h > 15)
      .slice(0, 15);

    const marketCapCoins = data
      .filter(c => c.market_cap && c.market_cap > 50000)
      .slice(0, 15);

    // Populate Newly Created table
    const newlyBody = document.getElementById('newlyCreatedBody');
    newlyBody.innerHTML = '';
    newlyCreated.forEach(coin => {
      const tr = document.createElement('tr');
      const tdName = document.createElement('td');
      tdName.textContent = coin.name;
      tdName.className = 'coin-name';
      const tdDate = document.createElement('td');
      // no creation date in API, show market cap as proxy
      tdDate.textContent = `$${formatNumber(coin.market_cap)}`;
      tr.appendChild(tdName);
      tr.appendChild(tdDate);
      newlyBody.appendChild(tr);
    });

    // Populate Pump Coins table
    const pumpBody = document.getElementById('pumpBody');
    pumpBody.innerHTML = '';
    pumpCoins.forEach(coin => {
      const tr = document.createElement('tr');
      const tdName = document.createElement('td');
      tdName.textContent = coin.name;
      tdName.className = 'coin-name';
      const tdChange = document.createElement('td');
      tdChange.textContent = coin.price_change_percentage_24h.toFixed(2) + '%';
      tdChange.className = 'price-change up';
      tr.appendChild(tdName);
      tr.appendChild(tdChange);
      pumpBody.appendChild(tr);
    });

    // Populate Market Cap > 50k table
    const mcBody = document.getElementById('marketCapBody');
    mcBody.innerHTML = '';
    marketCapCoins.forEach(coin => {
      const tr = document.createElement('tr');
      const tdName = document.createElement('td');
      tdName.textContent = coin.name;
      tdName.className = 'coin-name';
      const tdMc = document.createElement('td');
      tdMc.textContent = `$${formatNumber(coin.market_cap)}`;
      tr.appendChild(tdName);
      tr.appendChild(tdMc);
      mcBody.appendChild(tr);
    });
  }

  populateTables();
  // Optional: refresh every 30 seconds
  setInterval(populateTables, 30000);
</script>

</body>
</html>
