<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VexApi - Crypto Tracker</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap');

    body {
      margin: 0;
      background-color: #0a1a2a;
      color: #e0e0e0;
      font-family: 'Poppins', sans-serif;
      user-select: none;
      padding: 40px 20px;
    }

    h1 {
      text-align: center;
      font-weight: 700;
      font-size: 3rem;
      margin-bottom: 40px;
      color: #7a8a99;
      letter-spacing: 3px;
      text-transform: uppercase;
    }

    table {
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      border-collapse: separate;
      border-spacing: 0 12px;
    }

    thead tr {
      background-color: #4a4f58;
      color: #f0f0f0;
      text-transform: uppercase;
      font-weight: 700;
      font-size: 1rem;
      letter-spacing: 1.5px;
    }

    thead th {
      padding: 14px 12px;
      text-align: left;
      border-radius: 8px 8px 0 0;
    }

    tbody tr {
      background-color: #15243f;
      transition: background-color 0.3s ease;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgb(0 0 0 / 0.25);
      cursor: pointer;
    }

    tbody tr:hover {
      background-color: #2c3e6f;
    }

    tbody td {
      padding: 14px 12px;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .coin-name {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .coin-logo {
      width: 24px;
      height: 24px;
      border-radius: 50%;
    }

    .price-change {
      font-weight: 700;
      color: #ff6666;
    }

    .price-change.up {
      color: #7fff7f;
    }

    .btn {
      display: inline-block;
      background-color: #5a616d;
      color: #e0e0e0;
      border: none;
      padding: 10px 20px;
      font-weight: 600;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-decoration: none;
      margin: 12px 8px;
    }

    .btn:hover {
      background-color: #788492;
    }

    .btn-container {
      max-width: 1100px;
      margin: 30px auto;
      text-align: center;
    }

    @media (max-width: 768px) {
      table {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <h1>VexApi</h1>

  <table>
    <thead>
      <tr>
        <th>Coin</th>
        <th>Price</th>
        <th>24h Change</th>
        <th>Market Cap</th>
      </tr>
    </thead>
    <tbody id="coinTableBody">
      <tr><td colspan="4" style="text-align:center; color:#ff6666;">Loading...</td></tr>
    </tbody>
  </table>

  <div class="btn-container">
    <button class="btn" id="refreshBtn">Refresh Data</button>
    <a href="https://pump.fun/" class="btn" target="_blank">Create Your Own Coin</a>
  </div>

  <script>
    const tbody = document.getElementById('coinTableBody');
    const refreshBtn = document.getElementById('refreshBtn');

    async function fetchCoins() {
      try {
        const res = await fetch(
          'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=50&page=1&price_change_percentage=24h'
        );
        return await res.json();
      } catch (err) {
        console.error('Error:', err);
        return null;
      }
    }

    function formatNumber(num) {
      return num ? num.toLocaleString(undefined, { maximumFractionDigits: 0 }) : '-';
    }

    function formatPrice(num) {
      if (num < 0.01) return num.toFixed(6);
      if (num < 1) return num.toFixed(4);
      return num.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function createRow(coin) {
      const tr = document.createElement('tr');

      tr.onclick = () => {
        window.open(`https://dexscreener.com/search/${coin.symbol}`, '_blank');
      };

      // Coin name and logo
      const tdName = document.createElement('td');
      tdName.className = 'coin-name';
      const img = document.createElement('img');
      img.src = coin.image;
      img.alt = coin.name;
      img.className = 'coin-logo';
      tdName.appendChild(img);
      tdName.appendChild(document.createTextNode(coin.name));
      tr.appendChild(tdName);

      // Price
      const tdPrice = document.createElement('td');
      tdPrice.textContent = `$${formatPrice(coin.current_price)}`;
      tr.appendChild(tdPrice);

      // 24h Change
      const tdChange = document.createElement('td');
      tdChange.textContent = (coin.price_change_percentage_24h ?? 0).toFixed(2) + '%';
      tdChange.className = 'price-change ' + (coin.price_change_percentage_24h >= 0 ? 'up' : '');
      tr.appendChild(tdChange);

      // Market Cap
      const tdCap = document.createElement('td');
      tdCap.textContent = `$${formatNumber(coin.market_cap)}`;
      tr.appendChild(tdCap);

      return tr;
    }

    async function updateTable() {
      tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; color:#ff6666;">Loading...</td></tr>';
      const coins = await fetchCoins();
      if (!coins) {
        tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; color:#ff6666;">Error loading data</td></tr>';
        return;
      }

      tbody.innerHTML = '';
      coins.forEach((coin) => {
        const row = createRow(coin);
        tbody.appendChild(row);
      });
    }

    refreshBtn.addEventListener('click', updateTable);
    updateTable();
    setInterval(updateTable, 30000);
  </script>
</body>
</html>
